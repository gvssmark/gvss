<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Page Title</title>
<style>
body {margin:0 auto; width:300px;}

table tr td{border-collapse:collapse; border:1px solid black;   }
tr {height:30px; text-align:center}
th{position: sticky;  top:160px; background:red; color:white}
h3 {text-align:center}
</style>

</head>
<body>
<div style="background: rgba(255, 0, 145, 0.2)">
<h3>IBAP Retirees' Google Group</h1>
<div style='position:fixed; top:0; width:300px; background:yellow'>
<table width=100% id='table1'>
<tr><td >Jan<td >Feb<td >Mar
<tr><td >Apr<td >May<td >Jun
<tr><td >Jul<td >Aug<td >Sep
<tr><td >Oct<td >Nov<td >Dec
</table>
<table bgcolor=pink width=100%><tr><td onclick = selectEvent(1)>Birthdays<td style='background:rgba(0, 255, 5, 0.2)' onclick=selectEvent(2)>Marriage </table>
</div>
<p id='eventlist' style='margin:83px 5px; height:72vh; overflow-y: scroll; font-size:small'></p>

<script>
    url = 'https://script.google.com/macros/s/AKfycbwU43y7aw-hY8rjx77YgViB5Vs2H5yv7i5GMuUUfB6YMLbEQn3D/exec'
monthsArray = ["", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
 cd = new Date()
 month = cd.getMonth() + 1
        async function getMyData() {
            response = await fetch(url)
            data = await response.json()
            tempData = data["user"].sort((a, b) => a.srno - b.srno);
            alphasorted = tempData.sort(function (a, b) { return a.name.localeCompare(b.name) })
        bdays = alphasorted.map(a => ({ srno: a.srno, name: a.name, bm: a.bm, bd: a.bd }))
        mdays = alphasorted.map(a => ({ srno: a.srno, name: a.name, mm: a.mm, md: a.md }))                 }
        getMyData()
        
        function generateEvents(month){
        eventsB=bdays.filter(a =>a.bm===month).sort((a, b) => a.bd - b.bd)
        eventsM=mdays.filter(a =>a.mm===month).sort((a, b) => a.md - b.md)
        bdtable=""
        mdtable=""
        eventsB.forEach(function (a) { bdtable += "<tr><td>" + monthsArray[a.bm] + ", " + a.bd + "<td><span onClick='nameclick(this.id)' id=" + a.srno + ">" + a.name + "</span>" })
        eventsM.forEach(function (a) { mdtable += "<tr><td>" + monthsArray[a.mm] + ", " + a.md + "<td><span onClick='nameclick(this.id)' id=" + a.srno + ">" + a.name + "</span>" })
        }
        
        function monthClick(m){
        tablehead = '<table border=1 style="width:100%; border-collapse:collapse"><tr><th>Date<th>Name'
        generateEvents(m)
        document.getElementById("eventlist").innerHTML = tablehead + bdtable + "</table>"
        document.getElementById("eventlist").style.backgroundColor='rgba(255, 0, 145, 0.2)'
        }
function selectEvent(e){
bcolor='rgba(255, 0, 145, 0.2)'
mcolor = 'rgba(0, 255, 5, 0.2)'
e === 1 ? (document.getElementById("eventlist").innerHTML = tablehead + bdtable + "</table>", document.getElementById("eventlist").style.backgroundColor=bcolor) : (document.getElementById("eventlist").innerHTML = tablehead + mdtable + "</table>", document.getElementById("eventlist").style.backgroundColor=mcolor)
}        
    
    var cells = document.querySelectorAll("#table1 td");
for (var i = 0; i < cells.length; i++) {
  cells[i].addEventListener("click", function() {
 clickedcell = monthsArray.indexOf(this.innerHTML.replaceAll("\n",""))
  monthClick(clickedcell)
   });
}
        </script>

</body>
</html>


