<!DOCTYPE html>
<html>
<head>
<title>All Events</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {width:360px; height:90vh; background:yellowa;  margin:0 auto; }
div {border:1px solid black; margin:5px auto; width:350px; text-align:center; }
.div1 {margin-top:1px;  background:yellow; }
p {overflow-y:scroll; height:60vh; margin: auto 5px ;  font-size:small}
h1 {margin-top:0px; margin-bottom:0px; text-align:center  }
.table1 {border-collapse:collapse; height:150px;  }
</style>


</head>
<body>

<h1 >All Events</h1>
<div class='div1'>
<table class='table1' border=1 width=100% id='table1'>
<tr><td >Jan<td >Feb<td >Mar<td>Apr
<tr><td >May<td >Jun<td >Jul<td >Aug
<tr><td >Sep<td >Oct<td >Nov<td >Dec
</table>
</div>

<div>
<table  width=100%><tr><td style='background: rgba(255, 0, 145, 0.2)'  onclick = selectEvent(1)>Birthdays<td style='background:rgba(0, 255, 5, 0.2)' onclick=selectEvent(2)>Marriage </table>
</div>
<p id='eventlist'>
</p>

<script>
    url = 'https://script.google.com/macros/s/AKfycbwU43y7aw-hY8rjx77YgViB5Vs2H5yv7i5GMuUUfB6YMLbEQn3D/exec'
monthsArray = ["", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
 cd = new Date()
 month = cd.getMonth() + 1
        async function getMyData() {
            response = await fetch(url)
            data = await response.json()
            tempData = data["user"].sort((a, b) => a.srno - b.srno);
            alphasorted = tempData.sort(function (a, b) { return a.name.localeCompare(b.name) })
        bdays = alphasorted.map(a => ({ srno: a.srno, name: a.name, bm: a.bm, bd: a.bd }))
        mdays = alphasorted.map(a => ({ srno: a.srno, name: a.name, mm: a.mm, md: a.md }))                 }
        getMyData()
        
        function generateEvents(month){
        eventsB=bdays.filter(a =>a.bm===month).sort((a, b) => a.bd - b.bd)
        eventsM=mdays.filter(a =>a.mm===month).sort((a, b) => a.md - b.md)
        bdtable=""
        mdtable=""
        eventsB.forEach(function (a) { bdtable += "<tr><td>" + monthsArray[a.bm] + ", " + a.bd + "<td><span onClick='nameclick(this.id)' id=" + a.srno + ">" + a.name + "</span>" })
        eventsM.forEach(function (a) { mdtable += "<tr><td>" + monthsArray[a.mm] + ", " + a.md + "<td><span onClick='nameclick(this.id)' id=" + a.srno + ">" + a.name + "</span>" })
        }
        
        function monthClick(m){
        tablehead = '<table border=1 style="width:100%; border-collapse:collapse"><tr><th>Date<th>Name'
        generateEvents(m)
        document.getElementById("eventlist").innerHTML = tablehead + bdtable + "</table>"
        document.getElementById("eventlist").style.backgroundColor='rgba(255, 0, 145, 0.2)'
        }
function selectEvent(e){
bcolor='rgba(255, 0, 145, 0.2)'
mcolor = 'rgba(0, 255, 5, 0.2)'
e === 1 ? (document.getElementById("eventlist").innerHTML = tablehead + bdtable + "</table>", document.getElementById("eventlist").style.backgroundColor=bcolor) : (document.getElementById("eventlist").innerHTML = tablehead + mdtable + "</table>", document.getElementById("eventlist").style.backgroundColor=mcolor)
}        
    
    var cells = document.querySelectorAll("#table1 td");
for (var i = 0; i < cells.length; i++) {
  cells[i].addEventListener("click", function() {
  cells.forEach(function (a){a.style.backgroundColor="yellow"; a.style.color='black'; })
 clickedcell = monthsArray.indexOf(this.innerHTML.replaceAll("\n",""))
 this.style.backgroundColor='red'
this.style.color='white'
  monthClick(clickedcell)
   });
}
        </script>


</body>
</html>


